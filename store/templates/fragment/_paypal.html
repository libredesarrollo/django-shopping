<script src="https://www.paypal.com/sdk/js?client-id={{ paypal_client_id }}"></script>

<div id="paypalButtons"></div>

<script>
    fetch("{% url 's.create_checkout_session' %}", { method: "POST" })
        .then(response => response.json())
        {% comment %} .then(session => stripe.redirectToCheckout({ sessionId: session.id })) {% endcomment %}
        {% comment %} .catch(error => console.error("Error:", error)); {% endcomment %}
document.getElementById("checkout-button").addEventListener("click", function () {

});
</script>

<script>

    paypal.Buttons({
        createOrder: function(data, actions){
            return actions.order.create({
                purchase_units:[
                    {
                        amount: {
                            value:{{ price }}
                        }
                    }
                ]
            })
        },
        onApprove: function(data, actions){
 
            const csrfToken = '{{ csrf_token }}';
            // fetch(`/store/payment/${data.orderID}/{{id}}/paypal`, {
            fetch(`{{url}}`.replace('orderID', data.orderID), {
                method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': csrfToken
                    },
                })
                .then(response => response.json())
                .then(data => {
                    console.log('Success:', data);
                    // Redirect to success page or show success message
                })
                .catch((error) => {
                    console.error('Error:', error);
                });
        }
    }).render("#paypalButtons");
</script>
